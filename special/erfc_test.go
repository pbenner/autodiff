/* Copyright (C) 2016 Philipp Benner
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

package special

/* -------------------------------------------------------------------------- */

//import "fmt"
import "math"
import "testing"

/* -------------------------------------------------------------------------- */

func TestLogErfc(t *testing.T) {
  r := [][]float64{
    {  -6.00000,      0.693147180559945286226763982995 },
    {  -5.00000,      0.693147180559176567804513524607 },
    {  -4.00000,      0.693147172851316328845427960914 },
    {  -3.00000,      0.693136135250446816513658632175 },
    {  -2.00000,      0.690805573646587678382502417662 },
    {  -1.00000,      0.611232317678070513622401449538 },
    {   0.00000,     -0.000000000000000000000000000000 },
    {   1.00000,     -1.849605509933248459475407798891 },
    {   2.00000,     -5.364941264616637894846462586429 },
    {   3.00000,    -10.720363041981112672829112852924 },
    {   4.00000,    -17.987778312103007039013391477056 },
    {   5.00000,    -27.200889545537432212540807086043 },
    {   6.00000,    -38.377561173223391222109057707712 },
    {   7.00000,    -51.528231093710154198106465628371 },
    {   8.00000,    -66.659471970805157070572022348642 },
    {   9.00000,    -83.775669879529090167125104926527 },
    {  10.00000,   -102.879889024844885625498136505485 },
    {  11.00000,   -123.974350604226842165189736988395 },
    {  12.00000,   -147.060714177987023276727995835245 },
    {  13.00000,   -172.140251310094754444435238838196 },
    {  14.00000,   -199.213957224782859611877938732505 },
    {  15.00000,   -228.282625153806378648368990980089 },
    {  16.00000,   -259.346897344050319134112214669585 },
    {  17.00000,   -292.407300970730943845410365611315 },
    {  18.00000,   -327.464274001788965051673585548997 },
    {  19.00000,   -364.518184200240909831336466595531 },
    {  20.00000,   -403.569343334104246423521544784307 },
    {  21.00000,   -444.618017971645599573093932121992 },
    {  22.00000,   -487.664437799610709589614998549223 },
    {  23.00000,   -532.708802115371213403705041855574 },
    {  24.00000,   -579.751284953044546455203089863062 },
    {  25.00000,   -628.792039174071646812080871313810 },
    {  26.00000,   -679.831199763194263141485862433910 },
    {  27.00000,   -732.868886507897400406363885849714 },
    {  28.00000,   -787.905206194557763410557527095079 },
    {  29.00000,   -844.940254422147290824796073138714 },
    {  30.00000,   -903.974117110643874184461310505867 },
    {  31.00000,   -965.006871763745948555879294872284 },
    {  32.00000,  -1028.038588532358744487282820045948 },
    {  33.00000,  -1093.069331115387285535689443349838 },
    {  34.00000,  -1160.099157526790577321662567555904 },
    {  35.00000,  -1229.128120752022596207098104059696 },
    {  36.00000,  -1300.156269312447420816170051693916 },
    {  37.00000,  -1373.183647752780643713776953518391 },
    {  38.00000,  -1448.210297063809093742747791111469 },
    {  39.00000,  -1525.236255050429008406354114413261 },
    {  40.00000,  -1604.261556653273601114051416516304 },
    {  41.00000,  -1685.286234230772379305562935769558 },
    {  42.00000,  -1768.310317807345199980773031711578 },
    {  43.00000,  -1853.333835292490448409807868301868 },
    {  44.00000,  -1940.356812674766615600674413144588 },
    {  45.00000,  -2029.379274194044910473166964948177 },
    {  46.00000,  -2120.401242494884172629099339246750 },
    {  47.00000,  -2213.422738763458710309350863099098 },
    {  48.00000,  -2308.443782850109982973663136363029 },
    {  49.00000,  -2405.464393379294051555916666984558 },
    {  50.00000,  -2504.484587848451155878137797117233 },
    {  51.00000,  -2605.504382717108001088490709662437 },
    {  52.00000,  -2708.523793487346210895339027047157 },
    {  53.00000,  -2813.542834776625113590853288769722 },
    {  54.00000,  -2920.561520383811966894427314400673 },
    {  55.00000,  -3029.579863349167681008111685514450 },
    {  56.00000,  -3140.597876008933326374972239136696 },
    {  57.00000,  -3253.615570045101776486262679100037 },
    {  58.00000,  -3368.632956530862884392263367772102 },
    {  59.00000,  -3485.650045972174211783567443490028 },
    {  60.00000,  -3604.666848345843391143716871738434 },
    {  61.00000,  -3725.683373134468638454563915729523 },
    {  62.00000,  -3848.699629358540278190048411488533 },
    {  63.00000,  -3973.715625605982040724484249949455 },
    {  64.00000,  -4100.731370059366781788412481546402 },
    {  65.00000,  -4229.746870521023083711043000221252 },
    {  66.00000,  -4360.762134436236920009832829236984 },
    {  67.00000,  -4493.777168914698449952993541955948 },
    {  68.00000,  -4628.791980750373113551177084445953 },
    {  69.00000,  -4765.806576439917080278974026441574 },
    {  70.00000,  -4904.820962199773020984139293432236 },
    {  71.00000,  -5045.835143982052613864652812480927 },
    {  72.00000,  -5188.849127489312195393722504377365 },
    {  73.00000,  -5333.862918188308867684099823236465 },
    {  74.00000,  -5480.876521322818916814867407083511 },
    {  75.00000,  -5629.889941925605853612069040536880 },
    {  76.00000,  -5780.903184829582642123568803071976 },
    {  77.00000,  -5933.916254678259974753018468618393 },
    {  78.00000,  -6088.929155935510607378091663122177 },
    {  79.00000,  -6245.941892894717966555617749691010 },
    {  80.00000,  -6404.954469687345408601686358451843 },
    {  81.00000,  -6565.966890290978881239425390958786 },
    {  82.00000,  -6728.979158536870272655505686998367 },
    {  83.00000,  -6893.991278117031470173969864845276 },
    {  84.00000,  -7061.003252590897318441420793533325 },
    {  85.00000,  -7230.015085391598404385149478912354 },
    {  86.00000,  -7401.026779831866406311746686697006 },
    {  87.00000,  -7574.038339109598382492549717426300 },
    {  88.00000,  -7749.049766313100008119363337755203 },
    {  89.00000,  -7926.061064426041411934420466423035 },
    {  90.00000,  -8105.072236332126522029284387826920 },
    {  91.00000,  -8286.083284819511391106061637401581 },
    {  92.00000,  -8469.094212584976048674434423446655 },
    {  93.00000,  -8654.105022237876255530864000320435 },
    {  94.00000,  -8841.115716303882436477579176425934 },
    {  95.00000,  -9030.126297228516705217771232128143 },
    {  96.00000,  -9221.136767380508899805136024951935 },
    {  97.00000,  -9414.147129054979814100079238414764 },
    {  98.00000,  -9609.157384476462539169006049633026 },
    {  99.00000,  -9806.167535801756457658484578132629 },
    { 100.00000, -10005.177585122664822847582399845123 },
    {   0.00001,     -0.000011283855333035135924376127 },
    {   0.00006,     -0.000067705041879109910721822041 },
    {   0.00011,     -0.000124129411616539576165146874 },
    {   0.00016,     -0.000180556964622398678950443429 },
    {   0.00021,     -0.000236987700973758936683760679 },
    {   0.00026,     -0.000293421620747689180282863353 },
    {   0.00031,     -0.000349858724021255421739867719 },
    {   0.00036,     -0.000406299010871520745701024335 },
    {   0.00041,     -0.000462742481375545363676826671 },
    {   0.00046,     -0.000519189135610386505621793862 },
    {   0.00051,     -0.000575638973653098853615339703 },
    {   0.00056,     -0.000632091995580733945550577779 },
    {   0.00061,     -0.000688548201470340608815190464 },
    {   0.00066,     -0.000745007591398964526610559922 },
    {   0.00071,     -0.000801470165443648996893288849 },
    {   0.00076,     -0.000857935923681433956593245238 },
    {   0.00081,     -0.000914404866189356632134865865 },
    {   0.00086,     -0.000970876993044451539437156296 },
    {   0.00091,     -0.001027352304323750483913690879 },
    {   0.00096,     -0.001083830800104281693110874762 },
    {   0.00101,     -0.001140312480463070684069681882 },
    {   0.00106,     -0.001196797345477141130687392945 },
    {   0.00111,     -0.001253285395223512586893033216 },
    {   0.00116,     -0.001309776629779202655051717485 },
    {   0.00121,     -0.001366271049221225034400739595 },
    {   0.00126,     -0.001422768653626592123134786405 },
    {   0.00131,     -0.001479269443072311548958985838 },
    {   0.00136,     -0.001535773417635389638535858836 },
    {   0.00141,     -0.001592280577392828815400105391 },
    {   0.00146,     -0.001648790922421629334682080525 },
    {   0.00151,     -0.001705304452798788198905621805 },
    {   0.00156,     -0.001761821168601299808509352829 },
    {   0.00161,     -0.001818341069906154877644510748 },
    {   0.00166,     -0.001874864156790342819419725728 },
    {   0.00171,     -0.001931390429330848926975372493 },
    {   0.00176,     -0.001987919887604655891366611797 },
    {   0.00181,     -0.002044452531688742934201652446 },
    {   0.00186,     -0.002100988361660087976046096259 },
    {   0.00191,     -0.002157527377595665034337724109 },
    {   0.00196,     -0.002214069579572445524429102903 },
    {   0.00201,     -0.002270614967667396958544978602 },
    {   0.00206,     -0.002327163541957486415229228172 },
    {   0.00211,     -0.002383715302519674901493562658 },
    {   0.00216,     -0.002440270249430923424349693107 },
    {   0.00221,     -0.002496828382768188220319771631 },
    {   0.00226,     -0.002553389702608423357521605368 },
    {   0.00231,     -0.002609954209028580301987787493 },
    {   0.00236,     -0.002666521902105607050303959227 },
    {   0.00241,     -0.002723092781916449864332285813 },
    {   0.00246,     -0.002779666848538050235445373559 },
    {   0.00251,     -0.002836244102047348787654090785 },
    {   0.00256,     -0.002892824542521281808160615867 },
    {   0.00261,     -0.002949408170036783415762782212 },
    {   0.00266,     -0.003005994984670784693492340267 },
    {   0.00271,     -0.003062584986500214122295826513 },
    {   0.00276,     -0.003119178175601996279991956484 },
    {   0.00281,     -0.003175774552053054877037707726 },
    {   0.00286,     -0.003232374115930308419719629853 },
    {   0.00291,     -0.003288976867310674113281665498 },
    {   0.00296,     -0.003345582806271066560882543328 },
    {   0.00301,     -0.003402191932888395595191433074 },
    {   0.00306,     -0.003458804247239569314154028490 },
    {   0.00311,     -0.003515419749401493647311678359 },
    {   0.00316,     -0.003572038439451071488439648505 },
    {   0.00321,     -0.003628660317465200960823645815 },
    {   0.00326,     -0.003685285383520780187749377177 },
    {   0.00331,     -0.003741913637694701654651252554 },
    {   0.00336,     -0.003798545080063857846963681908 },
    {   0.00341,     -0.003855179710705134744908040290 },
    {   0.00346,     -0.003911817529695419196067440737 },
    {   0.00351,     -0.003968458537111593277535437352 },
    {   0.00356,     -0.004025102733030535596958632283 },
    {   0.00361,     -0.004081750117529123894621889690 },
    {   0.00366,     -0.004138400690684231574001383791 },
    {   0.00371,     -0.004195054452572728569126336851 },
    {   0.00376,     -0.004251711403271483079302495156 },
    {   0.00381,     -0.004308371542857360701750391030 },
    {   0.00386,     -0.004365034871407223564243604841 },
    {   0.00391,     -0.004421701388997931192470502992 },
    {   0.00396,     -0.004478371095706339642672499934 },
    {   0.00401,     -0.004535043991609302369005796152 },
    {   0.00406,     -0.004591720076783671090903116152 },
    {   0.00411,     -0.004648399351306292323626756513 },
    {   0.00416,     -0.004705081815254011715077275824 },
    {   0.00421,     -0.004761767468703672311070018708 },
    {   0.00426,     -0.004818456311732112820611639847 },
    {   0.00431,     -0.004875148344416169350623579959 },
    {   0.00436,     -0.004931843566832674538580327805 },
    {   0.00441,     -0.004988541979058461021956372150 },
    {   0.00446,     -0.005045243581170355366694035837 },
    {   0.00451,     -0.005101948373245183271373903722 },
    {   0.00456,     -0.005158656355359765230406132730 },
    {   0.00461,     -0.005215367527590921738200879787 },
    {   0.00466,     -0.005272081890015468952359611876 },
    {   0.00471,     -0.005328799442710219561036844027 },
    {   0.00476,     -0.005385520185751986252387091270 },
    {   0.00481,     -0.005442244119217573908309226738 },
    {   0.00486,     -0.005498971243183789145425599543 },
    {   0.00491,     -0.005555701557727433376188130865 },
    {   0.00496,     -0.005612435062925306278325265907 },
    {   0.00501,     -0.005669171758854202325395021944 },
    {   0.00506,     -0.005725911645590916858317154237 },
    {   0.00511,     -0.005782654723212239146479252128 },
    {   0.00516,     -0.005839400991794957591907166972 },
    {   0.00521,     -0.005896150451415857127179798169 },
    {   0.00526,     -0.005952903102151718348067355180 },
    {   0.00531,     -0.006009658944079320982978309473 },
    {   0.00536,     -0.006066417977275441290874180567 },
    {   0.00541,     -0.006123180201816852061269536023 },
    {   0.00546,     -0.006179945617780326083678943405 },
    {   0.00551,     -0.006236714225242627473999590393 },
    {   0.00556,     -0.006293486024280521215490402653 },
    {   0.00561,     -0.006350261014970770556686829877 },
    {   0.00566,     -0.006407039197390135276677369802 },
    {   0.00571,     -0.006463820571615369083018354246 },
    {   0.00576,     -0.006520605137723226550627853015 },
    {   0.00581,     -0.006577392895790456182891769998 },
    {   0.00586,     -0.006634183845893809085281223048 },
    {   0.00591,     -0.006690977988110025954926474157 },
    {   0.00596,     -0.006747775322515850958404737270 },
    {   0.00601,     -0.006804575849188021323399322426 },
    {   0.00606,     -0.006861379568203274277593539665 },
    {   0.00611,     -0.006918186479638342711862009082 },
    {   0.00616,     -0.006974996583569955180270660833 },
    {   0.00621,     -0.007031809880074841104247163059 },
    {   0.00626,     -0.007088626369229724701048755975 },
    {   0.00631,     -0.007145446051111325851123989850 },
    {   0.00636,     -0.007202268925796365302283152943 },
    {   0.00641,     -0.007259094993361556863442629606 },
    {   0.00646,     -0.007315924253883616945604018156 },
    {   0.00651,     -0.007372756707439252418789799037 },
    {   0.00656,     -0.007429592354105171020384190683 },
    {   0.00661,     -0.007486431193958077885686197561 },
    {   0.00666,     -0.007543273227074675547909610174 },
    {   0.00671,     -0.007600118453531660468736053105 },
    {   0.00676,     -0.007656966873405728242485412949 },
    {   0.00681,     -0.007713818486773574463477576302 },
    {   0.00686,     -0.007770673293711886919776787863 },
    {   0.00691,     -0.007827531294297354266809030321 },
    {   0.00696,     -0.007884392488606659088468120444 },
    {   0.00701,     -0.007941256876716484836009612991 },
    {   0.00706,     -0.007998124458703506287071682834 },
    {   0.00711,     -0.008054995234644405158186408755 },
    {   0.00716,     -0.008111869204615849288098061720 },
    {   0.00721,     -0.008168746368694508250274388672 },
    {   0.00726,     -0.008225626726957051618183136554 },
    {   0.00731,     -0.008282510279480147230568576333 },
    {   0.00736,     -0.008339397026340449048387171160 },
    {   0.00741,     -0.008396286967614616236765812118 },
    {   0.00746,     -0.008453180103379311430278342243 },
    {   0.00751,     -0.008510076433711179916263844802 },
    {   0.00756,     -0.008566975958686875655678782948 },
    {   0.00761,     -0.008623878678383042201138763971 },
    {   0.00766,     -0.008680784592876328309429823094 },
    {   0.00771,     -0.008737693702243372328997139675 },
    {   0.00776,     -0.008794606006560810873562417100 },
    {   0.00781,     -0.008851521505905284026294310706 },
    {   0.00786,     -0.008908440200353421462020619970 },
    {   0.00791,     -0.008965362089981851120845668390 },
    {   0.00796,     -0.009022287174867204412320731421 },
    {   0.00801,     -0.009079215455086104072379704633 },
    {   0.00806,     -0.009136146930715167632786055663 },
    {   0.00811,     -0.009193081601831016094750204104 },
    {   0.00816,     -0.009250019468510265255312141619 },
    {   0.00821,     -0.009306960530829530911511859870 },
    {   0.00826,     -0.009363904788865414982601542704 },
    {   0.00831,     -0.009420852242694526326727277876 },
    {   0.00836,     -0.009477802892393475536758629119 },
    {   0.00841,     -0.009534756738038857593053876371 },
    {   0.00846,     -0.009591713779707269210694775552 },
    {   0.00851,     -0.009648674017475310574210034531 },
    {   0.00856,     -0.009705637451419573194510981295 },
    {   0.00861,     -0.009762604081616643378338515902 },
    {   0.00866,     -0.009819573908143110901880490360 },
    {   0.00871,     -0.009876546931075560337154328749 },
    {   0.00876,     -0.009933523150490567582560075266 },
    {   0.00881,     -0.009990502566464715475391678012 },
    {   0.00886,     -0.010047485179074578179325705207 },
    {   0.00891,     -0.010104470988396729858038725069 },
    {   0.00896,     -0.010161459994507734266866449957 },
    {   0.00901,     -0.010218452197484162100038496135 },
    {   0.00906,     -0.010275447597402575378167099984 },
    {   0.00911,     -0.010332446194339539591311449840 },
    {   0.00916,     -0.010389447988371609821189878176 },
    {   0.00921,     -0.010446452979575335945350289535 },
    {   0.00926,     -0.010503461168027281719128396276 },
    {   0.00931,     -0.010560472553803984877007771104 },
    {   0.00936,     -0.010617487136981997031259794539 },
    {   0.00941,     -0.010674504917637861120538467219 },
    {   0.00946,     -0.010731525895848121818221265755 },
    {   0.00951,     -0.010788550071689309919897858947 },
    {   0.00956,     -0.010845577445237966629498771454 },
    {   0.00961,     -0.010902608016570621007890196097 },
    {   0.00966,     -0.010959641785763802115938325699 },
    {   0.00971,     -0.011016678752894035545062401127 },
    {   0.00976,     -0.011073718918037850356128615203 },
    {   0.00981,     -0.011130762281271763466938828913 },
    {   0.00986,     -0.011187808842672290060571427261 },
    {   0.00991,     -0.011244858602315948789551747211 },
    {   0.00996,     -0.011301911560279249632787745838 } }

  for i := 0; i < len(r); i++ {
    epsilon := 1e-10
    value   := LogErfc(r[i][0])
    target  := r[i][1]
    error   := math.Abs(value - target)
    if error > epsilon {
      t.Errorf("LogErfc() failed for `%f' with error `%e', value=%e, target=%e\n",
        r[i][0], error, value, target)
    }
  }

}
