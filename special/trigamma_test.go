/* Copyright (C) 2016 Philipp Benner
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

package special

/* -------------------------------------------------------------------------- */

//import "fmt"
import "math"
import "testing"

/* -------------------------------------------------------------------------- */

func TestTrigamma(t *testing.T) {
	r := [][]float64{
		{0.5, 4.93480220054467899615},
		{1.0, 1.64493406684822640607},
		{1.5, 0.93480220054467932922},
		{2.0, 0.64493406684822640607},
		{2.5, 0.49035775610023485394},
		{3.0, 0.39493406684822646158},
		{3.5, 0.33035775610023487836},
		{4.0, 0.28382295573711530112},
		{4.5, 0.24872510303901038120},
		{5.0, 0.22132295573711532888},
		{5.5, 0.19934238698962766789},
		{6.0, 0.18132295573711532111},
		{6.5, 0.16628453574995824549},
		{7.0, 0.15354517795933755875},
		{7.5, 0.14261589669670379776},
		{8.0, 0.13313701469403141364},
		{8.5, 0.12483811891892601653},
		{9.0, 0.11751201469403142752},
		{9.5, 0.11099728846909903690},
		{10.0, 0.10516633568168574919},
		{10.5, 0.09991695605912673250},
		{11.0, 0.09516633568168574031},
		{11.5, 0.09084666127454622819},
		{12.0, 0.08690187287176838471},
		{12.5, 0.08328522460157837537},
		{13.0, 0.07995742842732395106},
		{13.5, 0.07688522460157837246},
		{14.0, 0.07404026866401033913},
		{14.5, 0.07139825615164695216},
		{15.0, 0.06893822784768380285},
		{15.5, 0.06664201358327596914},
		{16.0, 0.06449378340323935754},
		{16.5, 0.06247968267796900205},
		{17.0, 0.06058753340323936448},
		{17.5, 0.05880658809578350604},
		{18.0, 0.05712732579078261264},
		{18.5, 0.05554128197333452893},
		{19.0, 0.05404090603769619305},
		{19.5, 0.05261944121365592919},
		{20.0, 0.05127082293520311695},
		{20.5, 0.04998959242996098978},
		{21.0, 0.04877082293520312167},
		{21.5, 0.04761005643947913840},
		{22.0, 0.04650324923905799213},
		{22.5, 0.04544672490892207734},
		{23.0, 0.04443713353657865323},
		{23.5, 0.04347141626694676908},
		{24.0, 0.04254677436833669002},
		{24.5, 0.04166064216101648260},
		{25.0, 0.04081066325722557814},
		{25.5, 0.03999466964956292087},
		{26.0, 0.03921066325722558088},
		{26.5, 0.03845679959958214766},
		{27.0, 0.03773137331639717790},
		{27.5, 0.03703280529555936368},
		{28.0, 0.03635963120391432629},
		{28.5, 0.03571049124597258650},
		{29.0, 0.03508412099983269222},
		{29.5, 0.03447934320042010670},
		{30.0, 0.03389506035773994647},
		{30.5, 0.03333024811280160815},
		{31.0, 0.03278394924662883514},
		{31.5, 0.03225526826867368413},
		{32.0, 0.03174336652030208816},
		{32.5, 0.03124745773705362925},
		{33.0, 0.03076680402030209163},
		{33.5, 0.03030071217492345120},
		{34.0, 0.02984853037475571763},
		{34.5, 0.02940964512212772969},
		{35.0, 0.02898347847164153140},
		{35.5, 0.02856948549179796557},
		{36.0, 0.02816715194102928366},
		{36.5, 0.02777599213730481270},
		{37.0, 0.02739554700275767876},
		{37.5, 0.02702538226678501479},
		{38.0, 0.02666508681283803056},
		{38.5, 0.02631427115567390104},
		{39.0, 0.02597256603721476154},
		{39.5, 0.02563962113037452847}}

	for i := 0; i < len(r); i++ {
		if math.Abs(Trigamma(r[i][0])-r[i][1]) > 1e-12 {
			t.Errorf("Trigamma() failed for `%f'\n", r[i][0])
		}
	}
}
